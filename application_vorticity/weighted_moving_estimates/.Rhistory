coord_sf(crs = st_crs(4326)) +
geom_raster(data = out_6h, alpha = 0.7,
aes(lon, lat, fill = tail_qb_jul1)) +
scale_fill_viridis_c(na.value = "white", option = "C",
direction = -1,
guide = guide_colorbar(order = 1),
limits = c(0.5, 1))+
labs(x = NULL, y = NULL, fill = NULL)
p3
p3 <- ggplot() +
# geom_map() function takes world coordinates
# as input to plot world map
geom_map(
data = world_coordinates, map = world_coordinates,
aes(long, lat, map_id = region) , color = "black",
fill = "white", size = 0.3
) +
scale_x_continuous(
limits = c(-40.5, 0.5),
expand = c(0,0),
breaks = seq(-60, 30, by = 10),  # Define longitude tick positions
labels = function(x) {
paste0(abs(x), "°", ifelse(x < 0, "W", ""))
}
) +
scale_y_continuous(
limits = c(44.5, 60.5),
expand = c(0,0),
breaks = seq(30, 60, by = 10),  # Define latitude tick positions
labels = function(y) {
paste0(abs(y), "°", ifelse(y < 0, "S", "N"))
}) +
coord_sf(crs = st_crs(4326)) +
geom_raster(data = out_6h, alpha = 0.7,
aes(lon, lat, fill = tail_ml_jul1)) +
scale_fill_viridis_c(na.value = "white", option = "C",
direction = -1,
guide = guide_colorbar(order = 1),
limits = c(0.5, 1))+
labs(x = NULL, y = NULL, fill = NULL)
p3
p2 <- ggplot() +
# geom_map() function takes world coordinates
# as input to plot world map
geom_map(
data = world_coordinates, map = world_coordinates,
aes(long, lat, map_id = region) , color = "black",
fill = "white", size = 0.3
) +
scale_x_continuous(
limits = c(-40.5, 0.5),
expand = c(0,0),
breaks = seq(-60, 30, by = 10),  # Define longitude tick positions
labels = function(x) {
paste0(abs(x), "°", ifelse(x < 0, "W", ""))
}
) +
scale_y_continuous(
limits = c(44.5, 60.5),
expand = c(0,0),
breaks = seq(30, 60, by = 10),  # Define latitude tick positions
labels = function(y) {
paste0(abs(y), "°", ifelse(y < 0, "S", "N"))
}) +
coord_sf(crs = st_crs(4326)) +
geom_raster(data = out_6h, alpha = 0.7,
aes(lon, lat, fill = tail_qb_apr1)) +
scale_fill_viridis_c(na.value = "white", option = "C",
direction = -1,
guide = guide_colorbar(order = 1),
limits = c(0.5, 1))+
labs(x = NULL, y = NULL, fill = NULL)
p2
p2 <- ggplot() +
# geom_map() function takes world coordinates
# as input to plot world map
geom_map(
data = world_coordinates, map = world_coordinates,
aes(long, lat, map_id = region) , color = "black",
fill = "white", size = 0.3
) +
scale_x_continuous(
limits = c(-40.5, 0.5),
expand = c(0,0),
breaks = seq(-60, 30, by = 10),  # Define longitude tick positions
labels = function(x) {
paste0(abs(x), "°", ifelse(x < 0, "W", ""))
}
) +
scale_y_continuous(
limits = c(44.5, 60.5),
expand = c(0,0),
breaks = seq(30, 60, by = 10),  # Define latitude tick positions
labels = function(y) {
paste0(abs(y), "°", ifelse(y < 0, "S", "N"))
}) +
coord_sf(crs = st_crs(4326)) +
geom_raster(data = out_6h, alpha = 0.7,
aes(lon, lat, fill = tail_ml_apr1)) +
scale_fill_viridis_c(na.value = "white", option = "C",
direction = -1,
guide = guide_colorbar(order = 1),
limits = c(0.5, 1))+
labs(x = NULL, y = NULL, fill = NULL)
p2
p4 <- ggplot() +
# geom_map() function takes world coordinates
# as input to plot world map
geom_map(
data = world_coordinates, map = world_coordinates,
aes(long, lat, map_id = region) , color = "black",
fill = "white", size = 0.3
) +
scale_x_continuous(
limits = c(-40.5, 0.5),
expand = c(0,0),
breaks = seq(-60, 30, by = 10),  # Define longitude tick positions
labels = function(x) {
paste0(abs(x), "°", ifelse(x < 0, "W", ""))
}
) +
scale_y_continuous(
limits = c(44.5, 60.5),
expand = c(0,0),
breaks = seq(30, 60, by = 10),  # Define latitude tick positions
labels = function(y) {
paste0(abs(y), "°", ifelse(y < 0, "S", "N"))
}) +
coord_sf(crs = st_crs(4326)) +
geom_raster(data = out_6h, alpha = 0.7,
aes(lon, lat, fill = tail_qb_oct1)) +
scale_fill_viridis_c(na.value = "white", option = "C",
direction = -1,
guide = guide_colorbar(order = 1),
limits = c(0.5, 1))+
labs(x = NULL, y = NULL, fill = NULL)
p4
p4 <- ggplot() +
# geom_map() function takes world coordinates
# as input to plot world map
geom_map(
data = world_coordinates, map = world_coordinates,
aes(long, lat, map_id = region) , color = "black",
fill = "white", size = 0.3
) +
scale_x_continuous(
limits = c(-40.5, 0.5),
expand = c(0,0),
breaks = seq(-60, 30, by = 10),  # Define longitude tick positions
labels = function(x) {
paste0(abs(x), "°", ifelse(x < 0, "W", ""))
}
) +
scale_y_continuous(
limits = c(44.5, 60.5),
expand = c(0,0),
breaks = seq(30, 60, by = 10),  # Define latitude tick positions
labels = function(y) {
paste0(abs(y), "°", ifelse(y < 0, "S", "N"))
}) +
coord_sf(crs = st_crs(4326)) +
geom_raster(data = out_6h, alpha = 0.7,
aes(lon, lat, fill = tail_ml_oct1)) +
scale_fill_viridis_c(na.value = "white", option = "C",
direction = -1,
guide = guide_colorbar(order = 1),
limits = c(0.5, 1))+
labs(x = NULL, y = NULL, fill = NULL)
p4
p1_scale <- ggplot() +
# geom_map() function takes world coordinates
# as input to plot world map
geom_map(
data = world_coordinates, map = world_coordinates,
aes(long, lat, map_id = region) , color = "black",
fill = "white", size = 0.3
) +
scale_x_continuous(
limits = c(-40.5, 0.5),
expand = c(0,0),
breaks = seq(-60, 30, by = 10),  # Define longitude tick positions
labels = function(x) {
paste0(abs(x), "°", ifelse(x < 0, "W", ""))
}
) +
scale_y_continuous(
limits = c(44.5, 60.5),
expand = c(0,0),
breaks = seq(30, 60, by = 10),  # Define latitude tick positions
labels = function(y) {
paste0(abs(y), "°", ifelse(y < 0, "S", "N"))
}) +
coord_sf(crs = st_crs(4326)) +
geom_raster(data = out_6h, alpha = 0.7,
aes(lon, lat, fill = scale_qb_jan1)) +
scale_fill_gradientn(na.value = "white", colors = c(rainbow(10)[-10], "darkmagenta"),
limits = c(170, 2503),  trans = "log10")+
labs(x = NULL, y = NULL, fill = NULL)
p1_scale
p1_scale <- ggplot() +
# geom_map() function takes world coordinates
# as input to plot world map
geom_map(
data = world_coordinates, map = world_coordinates,
aes(long, lat, map_id = region) , color = "black",
fill = "white", size = 0.3
) +
scale_x_continuous(
limits = c(-40.5, 0.5),
expand = c(0,0),
breaks = seq(-60, 30, by = 10),  # Define longitude tick positions
labels = function(x) {
paste0(abs(x), "°", ifelse(x < 0, "W", ""))
}
) +
scale_y_continuous(
limits = c(44.5, 60.5),
expand = c(0,0),
breaks = seq(30, 60, by = 10),  # Define latitude tick positions
labels = function(y) {
paste0(abs(y), "°", ifelse(y < 0, "S", "N"))
}) +
coord_sf(crs = st_crs(4326)) +
geom_raster(data = out_6h, alpha = 0.7,
aes(lon, lat, fill = scale_ml_jan1)) +
scale_fill_gradientn(na.value = "white", colors = c(rainbow(10)[-10], "darkmagenta"),
limits = c(170, 2503),  trans = "log10")+
labs(x = NULL, y = NULL, fill = NULL)
p1_scale
p2_scale <- ggplot() +
# geom_map() function takes world coordinates
# as input to plot world map
geom_map(
data = world_coordinates, map = world_coordinates,
aes(long, lat, map_id = region) , color = "black",
fill = "white", size = 0.3
) +
scale_x_continuous(
limits = c(-40.5, 0.5),
expand = c(0,0),
breaks = seq(-60, 30, by = 10),  # Define longitude tick positions
labels = function(x) {
paste0(abs(x), "°", ifelse(x < 0, "W", ""))
}
) +
scale_y_continuous(
limits = c(44.5, 60.5),
expand = c(0,0),
breaks = seq(30, 60, by = 10),  # Define latitude tick positions
labels = function(y) {
paste0(abs(y), "°", ifelse(y < 0, "S", "N"))
}) +
coord_sf(crs = st_crs(4326)) +
geom_raster(data = out_6h, alpha = 0.7,
aes(lon, lat, fill = scale_qb_apr1)) +
scale_fill_gradientn(na.value = "white", colors = c(rainbow(10)[-10], "darkmagenta"),
limits = c(170, 2503),  trans = "log10")+
labs(x = NULL, y = NULL, fill = NULL)
p2_scale
p2_scale <- ggplot() +
# geom_map() function takes world coordinates
# as input to plot world map
geom_map(
data = world_coordinates, map = world_coordinates,
aes(long, lat, map_id = region) , color = "black",
fill = "white", size = 0.3
) +
scale_x_continuous(
limits = c(-40.5, 0.5),
expand = c(0,0),
breaks = seq(-60, 30, by = 10),  # Define longitude tick positions
labels = function(x) {
paste0(abs(x), "°", ifelse(x < 0, "W", ""))
}
) +
scale_y_continuous(
limits = c(44.5, 60.5),
expand = c(0,0),
breaks = seq(30, 60, by = 10),  # Define latitude tick positions
labels = function(y) {
paste0(abs(y), "°", ifelse(y < 0, "S", "N"))
}) +
coord_sf(crs = st_crs(4326)) +
geom_raster(data = out_6h, alpha = 0.7,
aes(lon, lat, fill = scale_ml_apr1)) +
scale_fill_gradientn(na.value = "white", colors = c(rainbow(10)[-10], "darkmagenta"),
limits = c(170, 2503),  trans = "log10")+
labs(x = NULL, y = NULL, fill = NULL)
p2_scale
p3_scale <- ggplot() +
# geom_map() function takes world coordinates
# as input to plot world map
geom_map(
data = world_coordinates, map = world_coordinates,
aes(long, lat, map_id = region) , color = "black",
fill = "white", size = 0.3
) +
scale_x_continuous(
limits = c(-40.5, 0.5),
expand = c(0,0),
breaks = seq(-60, 30, by = 10),  # Define longitude tick positions
labels = function(x) {
paste0(abs(x), "°", ifelse(x < 0, "W", ""))
}
) +
scale_y_continuous(
limits = c(44.5, 60.5),
expand = c(0,0),
breaks = seq(30, 60, by = 10),  # Define latitude tick positions
labels = function(y) {
paste0(abs(y), "°", ifelse(y < 0, "S", "N"))
}) +
coord_sf(crs = st_crs(4326)) +
geom_raster(data = out_6h, alpha = 0.7,
aes(lon, lat, fill = scale_qb_jul1)) +
scale_fill_gradientn(na.value = "white", colors = c(rainbow(10)[-10], "darkmagenta"),
limits = c(170, 2503), trans = "log10")+
labs(x = NULL, y = NULL, fill = NULL)
p3_scale
p3_scale <- ggplot() +
# geom_map() function takes world coordinates
# as input to plot world map
geom_map(
data = world_coordinates, map = world_coordinates,
aes(long, lat, map_id = region) , color = "black",
fill = "white", size = 0.3
) +
scale_x_continuous(
limits = c(-40.5, 0.5),
expand = c(0,0),
breaks = seq(-60, 30, by = 10),  # Define longitude tick positions
labels = function(x) {
paste0(abs(x), "°", ifelse(x < 0, "W", ""))
}
) +
scale_y_continuous(
limits = c(44.5, 60.5),
expand = c(0,0),
breaks = seq(30, 60, by = 10),  # Define latitude tick positions
labels = function(y) {
paste0(abs(y), "°", ifelse(y < 0, "S", "N"))
}) +
coord_sf(crs = st_crs(4326)) +
geom_raster(data = out_6h, alpha = 0.7,
aes(lon, lat, fill = scale_ml_jul1)) +
scale_fill_gradientn(na.value = "white", colors = c(rainbow(10)[-10], "darkmagenta"),
limits = c(170, 2503), trans = "log10")+
labs(x = NULL, y = NULL, fill = NULL)
p3_scale
p4_scale <- ggplot() +
# geom_map() function takes world coordinates
# as input to plot world map
geom_map(
data = world_coordinates, map = world_coordinates,
aes(long, lat, map_id = region) , color = "black",
fill = "white", size = 0.3
) +
scale_x_continuous(
limits = c(-40.5, 0.5),
expand = c(0,0),
breaks = seq(-60, 30, by = 10),  # Define longitude tick positions
labels = function(x) {
paste0(abs(x), "°", ifelse(x < 0, "W", ""))
}
) +
scale_y_continuous(
limits = c(44.5, 60.5),
expand = c(0,0),
breaks = seq(30, 60, by = 10),  # Define latitude tick positions
labels = function(y) {
paste0(abs(y), "°", ifelse(y < 0, "S", "N"))
}) +
coord_sf(crs = st_crs(4326)) +
geom_raster(data = out_6h, alpha = 0.7,
aes(lon, lat, fill = scale_qb_oct1)) +
scale_fill_gradientn(na.value = "white", colors = c(rainbow(10)[-10], "darkmagenta"),
limits = c(170, 2503),  trans = "log10")+
labs(x = NULL, y = NULL, fill = NULL)
p4_scale
p4_scale <- ggplot() +
# geom_map() function takes world coordinates
# as input to plot world map
geom_map(
data = world_coordinates, map = world_coordinates,
aes(long, lat, map_id = region) , color = "black",
fill = "white", size = 0.3
) +
scale_x_continuous(
limits = c(-40.5, 0.5),
expand = c(0,0),
breaks = seq(-60, 30, by = 10),  # Define longitude tick positions
labels = function(x) {
paste0(abs(x), "°", ifelse(x < 0, "W", ""))
}
) +
scale_y_continuous(
limits = c(44.5, 60.5),
expand = c(0,0),
breaks = seq(30, 60, by = 10),  # Define latitude tick positions
labels = function(y) {
paste0(abs(y), "°", ifelse(y < 0, "S", "N"))
}) +
coord_sf(crs = st_crs(4326)) +
geom_raster(data = out_6h, alpha = 0.7,
aes(lon, lat, fill = scale_ml_oct1)) +
scale_fill_gradientn(na.value = "white", colors = c(rainbow(10)[-10], "darkmagenta"),
limits = c(170, 2503),  trans = "log10")+
labs(x = NULL, y = NULL, fill = NULL)
p4_scale
ggarrange(p1, p2, p3, p4,
p1_scale, p2_scale, p3_scale, p4_scale, ncol = 4, nrow = 2)
tail_ml <- matrix(nrow = 656, ncol = 4)
lines(res_ml_648$tail, col = "darkred")
plot(res_648$tail, type = "l")
lines(res_ml_648$tail, col = "darkred")
plot(res_648$scale, type = "l")
lines(res_ml_648$scale, col = "darkred")
p1
p2
p3
p4
p1_scale
p2_scale
p3_scale
which(out_6h$lat == 10)
which(out_6h$lon == 10)
which(out_6h$lon == -10)
which(out_6h$lon == -10 & out_6h$lat == 52)
plot(res_488$tail, type = "l")
which(out_6h$lon == -9 & out_6h$lat == 53)
plot(res_505$tail, type = "l")
p3
which(out_6h$lon == -10 & out_6h$lat == 54)
plot(res_490$tail, type = "l")
lines(res_ml_490$tail, col = "darkred")
print(get(paste("res_", k, sep = ""))$tail)
print(get(paste("res_", k, sep = ""))$tail-
get(paste("res_ml_", k, sep = ""))$tail)
print(sum(get(paste("res_", k, sep = ""))$tail-
get(paste("res_ml_", k, sep = ""))$tail))
print(sum((get(paste("res_", k, sep = ""))$tail-
get(paste("res_ml_", k, sep = ""))$tail)^2)
}
for (i in 1:656) {
print(sum((get(paste("res_", k, sep = ""))$tail-
get(paste("res_ml_", k, sep = ""))$tail)^2))
}
for (i in 1:656) {
print(sum((get(paste("res_", i, sep = ""))$tail-
get(paste("res_ml_", i, sep = ""))$tail)^2))
}
dist <- numeric(656)
for (i in 1:656) {
dist[i] <- sum((get(paste("res_", i, sep = ""))$tail-
get(paste("res_ml_", i, sep = ""))$tail)^2)
}
dist
min(dist)
dist <- numeric(656)
for (i in 1:656) {
dist[i] <- sqrt(sum((get(paste("res_", i, sep = ""))$tail-
get(paste("res_ml_", i, sep = ""))$tail)^2))
}
min(dist)
which.min(dist)
plot(res_91$tail, type = "l")
lines(res_ml_91$tail, col = "darkred")
plot(res_91$scale, type = "l")
lines(res_ml_91$scale, col = "darkred")
sort(dist)
order(dist)
plot(res_137$tail, type = "l")
lines(res_ml_137$tail, col = "darkred")
plot(res_137$scale, type = "l")
lines(res_ml_137$scale, col = "darkred")
plot(res_34$tail, type = "l")
lines(res_ml_34$tail, col = "darkred")
plot(res_34$scale, type = "l")
lines(res_ml_34$scale, col = "darkred")
plot(res_91$tail, type = "l")
lines(res_ml_91$tail, col = "darkred")
plot(res_137$tail, type = "l")
lines(res_ml_137$tail, col = "darkred")
plot(res_34$tail, type = "l")
lines(res_ml_34$tail, col = "darkred")
plot(res_2$scale, type = "l")
plot(res_2$tail, type = "l")
lines(res_ml_2$tail, col = "darkred")
plot(res_7$scale, type = "l")
plot(res_7$tail, type = "l")
lines(res_ml_7$tail, col = "darkred")
plot(res_34$tail, type = "l")
lines(res_ml_34$tail, col = "darkred")
plot(res_7$tail, type = "l")
lines(res_ml_7$tail, col = "darkred")
plot(res_36$tail, type = "l")
lines(res_ml_36$tail, col = "darkred")
plot(res_7$tail, type = "l")
lines(res_ml_7$tail, col = "darkred")
plot(res_34$scale, type = "l")
lines(res_ml_34$scale, col = "darkred")
plot(res_7$scale, type = "l")
lines(res_ml_7$scale, col = "darkred")
plot(res_34$tail, type = "l")
lines(res_ml_34$tail, col = "darkred")
plot(res_34$scale, type = "l")
lines(res_ml_34$scale, col = "darkred")
setwd("~/paper2/application_vorticity/weighted_moving_estimates")
load("weighted_ml_34.RData")
View(daily_res)
View(daily_res)
ymd("2022-01-01")
